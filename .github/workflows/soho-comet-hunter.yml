name: Test SOHO Detection
on: workflow_dispatch

jobs:
  test:
    runs-on: ubuntu-latest
    timeout-minutes: 15
    
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        
      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"
          
      - name: Install minimal
        run: |
          sudo apt-get update
          sudo apt-get install -y libgl1-mesa-glx libsm6 libxext6
          pip install numpy opencv-python-headless requests
          
      - name: Test basic functionality
        run: |
          echo "=== Testing Python imports ==="
          python3 -c "
import cv2
import numpy as np
print(f'OpenCV version: {cv2.__version__}')
print(f'NumPy version: {np.__version__}')
print('Basic imports successful!')
          "
          
      - name: Create test structure
        run: |
          mkdir -p frames/C2 frames/C3
          mkdir -p detections
          echo '{"test": "success"}' > detections/test.json
          
      - name: Verify
        run: |
          echo "Directory structure:"
          find . -type d | sort
          echo -e "\nTest file:"
          cat detections/test.json
